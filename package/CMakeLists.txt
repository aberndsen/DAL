include(InstallRequiredSystemLibraries)

set(CPACK_GENERATOR "DEB;TGZ;RPM")

set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "DAL - Data Access Library for HDF5 datasets from LOFAR and other sources")
set(CPACK_PACKAGE_DESCRIPTION_FILE "${CMAKE_CURRENT_SOURCE_DIR}/../README.txt")
set(CPACK_RESOURCE_FILE_LICENSE "${CMAKE_CURRENT_SOURCE_DIR}/../LICENSE.txt")
set(CPACK_PACKAGE_VERSION_MAJOR "${DAL_VERSION_MAJOR}")
set(CPACK_PACKAGE_VERSION_MINOR "${DAL_VERSION_MINOR}")
set(CPACK_PACKAGE_VERSION_PATCH "${DAL_VERSION_PATCH}")

set(CPACK_PACKAGE_VENDOR "Netherlands Institude for Radio Astronomy (ASTRON)")
set(CPACK_PACKAGE_CONTACT "Dr. Jan David Mol (mol@astron.nl)")

set(CPACK_PACKAGE_INSTALL_DIRECTORY "CMake ${CMake_VERSION_MAJOR}.${CMake_VERSION_MINOR}")

set(CPACK_DEBIAN_PACKAGE_SECTION "libs")
set(CPACK_DEBIAN_PACKAGE_DEPENDS "libhdf5 (= ${HDF5_VERSION}), python (>= 2.3)")

if(NOT CPACK_DEBIAN_PACKAGE_ARCHITECTURE AND NOT CMAKE_CROSSCOMPILING)
  find_program(DPKG_CMD dpkg)

  if(DPKG_CMD)
    execute_process(COMMAND "${DPKG_CMD}" --print-architecture
      OUTPUT_VARIABLE CPACK_DEBIAN_PACKAGE_ARCHITECTURE
      OUTPUT_STRIP_TRAILING_WHITESPACE
    )
  endif(DPKG_CMD)
endif(NOT CPACK_DEBIAN_PACKAGE_ARCHITECTURE AND NOT CMAKE_CROSSCOMPILING)

set(CPACK_RPM_PACKAGE_LICENSE "LGPL v3")
set(CPACK_RPM_PACKAGE_GROUP "Development/Libraries")
set(CPACK_RPM_PACKAGE_REQUIRES "libhdf5 = ${HDF5_VERSION}, python >= 2.3")

include(CPack)

